<div fxLayout="row" class="sublet-portal-tab">
    <div fxLayout="row" fxFlexOffset="38" *ngIf="isLoadingSublet">
        <div style="margin-top: 180px; text-align: center; font-size: 20px;">
            <mat-spinner style="margin-left: auto; margin-right: auto; display: block;" color="accent" [diameter]="40"></mat-spinner>
            <p style="text-align: center; font-size: 20px; color: #1E2129"> Loading Sublet Portal...</p>
       </div>
    </div>
    
    <mat-accordion fxFlex="100" *ngIf="!isLoadingSublet">
        <div class="p-16">
            <table class="simple">
                <thead>
                    <tr>
                        <td width="20%" class="font-size-12 blue-fg">
                                <div class="font-size-12 mb-8">
                                    VENDOR | ACTIVITY 
                                    <mat-icon matBadge="5" matBadgeColor="warn" matBadgeOverlap="true" class="s-20 blue-fg">notifications</mat-icon>
                                </div>
                                <div class="red p-4 font-size-10 border-radius-4 w-100 text-center"> Clear All Activity</div>
                            
                        </td>
                        <td width="14%" class="font-size-12 blue-fg">DATE SENT <mat-icon class="s-16">expand_more</mat-icon></td>
                        <td width="14%" class="font-size-12 blue-fg">AMOUNT</td>
                        <td width="20%" class="font-size-12 blue-fg">RECENT ACTIVITY <mat-icon class="s-16">expand_more</mat-icon></td>
                        <td width="14%" class="font-size-12 blue-fg">DEALERSHIP <mat-icon class="s-16">expand_more</mat-icon></td>
                        <td width="10%" class="font-size-12 blue-fg">STATUS <mat-icon class="s-16">expand_more</mat-icon></td>
                        <td width="8%" class="font-size-12 blue-fg"><mat-icon>menu</mat-icon></td>
                    </tr>
                </thead>
            </table>
        </div>
        
        <mat-expansion-panel *ngFor="let items of subletPortalItems; let i = index">
            <mat-expansion-panel-header  (click)="getCompanyVendor(items.companyVendorType)">
                    <table class="simple">
                        <tbody>
                            <tr>
                                <td width="20%">
                                    <div class="font-size-12 blue-fg">{{items.make}}</div>
                                    <div class="font-size-10">#{{items.stockNumber}}</div>
                                    <div class="font-size-8">{{items.model}}</div>
                                </td>
                                <td width="14%" >
                                    <div class="font-size-12">{{items.createDate | date:'EEE d, yyyy'}}</div>
                                    <div class="font-size-10">{{items.createDate | date: 'h:mm:ss: a'}}</div>
                                </td>
                                <td width="14%" >
                                    <div class="font-size-10 blue-600-fg">Estimate</div>
                                    <div class="font-size-10 indigo-fg"> {{items.year}}</div>
                                   
                                </td>
                                <td width="20%"  class="font-size-10">
                                    {{items.repairRequested}}
                                </td>
                                <td width="14%"  class="font-size-10">{{items.companyName}}</td>
                                <td width="10%" class="amber-700">
                                    <div class="font-size-10 fuse-white-fg text-center p-32">
                                        Pending approval
                                    </div>
                                </td>
                                <td width="8%">&nbsp;</td>
                            </tr>
                        </tbody>
                    </table>
                
            </mat-expansion-panel-header>
            
            <div fxLayout="column" class="pt-8  grey">
                    <mat-tab-group disableRipple="true">
                        <mat-tab label="Estimate Request">
                            <div *ngIf="isLoading" style="margin-top: 3%; margin-bottom: 3%">
                                <mat-spinner style="margin-left: auto; margin-right: auto; display: block;" color="accent" [diameter]="40"></mat-spinner>
                                <p style="text-align: center; font-size: 20px; color: #1E2129"> Loading Sublet Details...</p>
                            </div>
                            <div *ngIf="!isLoading" fxLayout="column" class="py-8 px-12">
                                <div fxLayout="row" fxLayoutGap="10px">
                                    <div fxLayout="column" fxFlex="60">
                                        <div class="mat-card p-4">
                                            <div fxLayout="column">
                                                <div class="px-8 border-bottom" fxLayout="row" fxLayoutAlign="start">

                                                    <div fxFlex class="py-8 h6 text-bold">Vendor User Detail</div>
                                                </div>
                                                <table class="">
                                                    <tbody>
                                                        <tr>
                                                            <td width="40%"><label class="font-size-10 text-bold"><mat-icon class="s-12">person</mat-icon> First Name</label></td>
                                                            <td width="35%"><label class="font-size-10 text-bold"><mat-icon class="s-12">account_circle</mat-icon> Last Name</label></td>
                                                            <td><label class="font-size-10 text-bold"><mat-icon class="s-12">account_balance</mat-icon> Other Name</label></td>
                                                        </tr>
                                                        <tr>
                                                            <td><label class="font-size-10 blue-fg text-bold">{{userfromVendorObject?.fname || 'Not Available'}}</label></td>
                                                            <td><label class="font-size-10 blue-fg text-bold">{{userfromVendorObject?.sname || 'Not Available'}}</label></td>
                                                            <td><label class="font-size-10 blue-fg text-bold">{{userfromVendorObject?.oname || 'Not Available'}}</label></td>
                                                        </tr>
                                                        <tr>
                                                            <td><label class="font-size-10 text-bold"><mat-icon class="s-12">phone</mat-icon> Mobile</label></td>
                                                            <td><label class="font-size-10 text-bold"><mat-icon class="s-12">mail</mat-icon> Email</label></td>
                                                            <td><label class="font-size-10 text-bold"><mat-icon class="s-12">home</mat-icon> Address</label></td>
                                                        </tr>
                                                        <tr>
                                                            <td><label class="font-size-10 blue-fg text-bold">{{userfromVendorObject?.contact || 'Not Available'}}</label></td>
                                                            <td><label class="font-size-10 blue-fg text-bold">{{userfromVendorObject?.email || 'Not Available'}}</label></td>
                                                            <td><label class="font-size-10 blue-fg text-bold">{{userfromVendorObject?.address || 'Not Available'}}</label></td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                        <div class="mat-card p-4 mt-4">
                                            <div fxLayout="column">
                                                <table class="">
                                                    <tbody>
                                                        <tr>
                                                            <td><label class="font-size-10 text-bold"><mat-icon class="s-12">airport_shuttle</mat-icon> Vehicle</label></td>
                                                            <td><label class="font-size-10 text-bold"><mat-icon class="s-12">library_books</mat-icon> Vin #</label></td>
                                                            <td><label class="font-size-10 text-bold"><mat-icon class="s-12">fiber_smart_record</mat-icon> Color / Miles</label></td>
                                                        </tr>
                                                        <tr>
                                                            <td><label class="font-size-10 blue-fg text-bold">({{items.year}}) {{items.make}} {{items.model}}</label></td>
                                                            <td><label class="font-size-10 blue-fg text-bold">{{items.VIN}}</label></td>
                                                            <td><label class="font-size-10 blue-fg text-bold">White / 46.985</label></td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                        <div class="mat-card p-4 mt-4">
                                            <div fxLayout="column">
                                                <table class="">
                                                    <tbody>
                                                        <tr>
                                                            <td><label class="font-size-10 text-bold">Damage</label></td>
                                                        </tr>
                                                        <tr>
                                                            <td><label class="font-size-10 blue-fg text-bold">Front right wheel damaged</label></td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                        <div class="mat-card p-4 mt-4">
                                            <div fxLayout="column">
                                                <table class="">
                                                    <tbody>
                                                        <tr>
                                                            <td><label class="font-size-10 text-bold">Repair Requested</label></td>
                                                        </tr>
                                                        <tr>
                                                            <td><label class="font-size-10 blue-fg text-bold"> {{items.repairRequested}}</label></td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                        <div class="mat-card p-4 mt-4">
                                            <div fxLayout="column">
                                                <table class="">
                                                    <tbody>
                                                        <tr>
                                                            <td><label class="font-size-10 text-bold">Advisor Notes</label></td>
                                                        </tr>
                                                        <tr>
                                                            <td><label class="font-size-10 blue-fg text-bold">How long will it take?</label></td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                    <div fxLayout="column" fxFlex="40">
                                        <div fxLayout="column" class="mat-card p-4">
                                            <mat-form-field appearance="outline" class="mt-8">
                                                <mat-label>Select Company Vendor</mat-label>
                                                <mat-select #compVendor (selectionChange)="getVendorUsers(compVendor.value.listOfVendorUsers)">
                                                    <mat-option *ngFor="let vendor of companyVendors" [value]="vendor">{{vendor.name}}</mat-option>
                                                </mat-select>
                                            </mat-form-field>
                                            <mat-form-field appearance="outline" *ngIf="isVendorSelected">
                                                <mat-label>Select Vendor Users</mat-label>
                                                <mat-select #vendorUser (selectionChange)="getVendorUser(vendorUser.value)">
                                                    <mat-option *ngFor="let user of vendorUsers" [value]="user">{{user.fname}} {{user.sname}}</mat-option>
                                                </mat-select>
                                            </mat-form-field>
                                        </div>
                                        <div class="mat-card p-4 mt-8" style="max-height: 300px; overflow: auto;">
                                            <div fxLayout="column">
                                                <table class="simple">
                                                    <thead>
                                                        <tr>
                                                            <th><mat-icon class="s-16">access_time</mat-icon> Request Activities</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr *ngFor="let activity of items.requestActivity">
                                                            <td>
                                                                <div class="font-size-12 text-bold">{{activity.activityTypeName}}</div>
                                                                <div class="font-size-10 text-secondary">{{activity.description}}</div>
                                                                <div class="font-size-10 blue-600-fg">{{activity.createDate | date:'short'}}</div>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </mat-tab>
                        <mat-tab label="Quote Activity">
                            <div fxLayout="column" class="py-8 px-12">
                                <div fxLayout="row" fxLayoutGap="10px">
                                    <div fxLayout="column" fxFlex="50">
                                        <div class="mat-card p-4" style="max-height: 300px; overflow: auto;">
                                            <div class="px-8 border-bottom" fxLayout="row" fxLayoutAlign="start">

                                                <div fxFlex class="h6 text-bold"><mat-icon class="s-20">record_voice_over</mat-icon> Quotes</div>
                                            </div>
                                            <div fxLayout="column">
                                                <table class="simple">
                                                    <tbody>
                                                        <tr *ngFor="let quote of items.quotes">
                                                            <td>
                                                                <div class="font-size-12 text-bold">
                                                                    <mat-icon class="s-32">attachment</mat-icon> Filename.ext
                                                                </div>
                                                                
                                                            </td>
                                                            <td>
                                                                <div class="font-size-12 text-bold">
                                                                    {{quote.name}}
                                                                </div> 
                                                                <div class="font-size-10 text-secondary">
                                                                    {{quote.comment}}
                                                                </div>     
                                                            </td>
                                                            <td>
                                                                <div class="font-size-10 text-bold green-600-fg">
                                                                    {{quote.amount | currency}}
                                                                </div>
                                                                <div class="font-size-10 blue-600-fg">
                                                                    {{quote.createDate | date:'short'}}
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                    <div fxLayout="column" fxFlex="50">
                                        <div class="mat-card p-4" style="max-height: 300px; overflow: auto;">
                                            <div class="px-8 border-bottom" fxLayout="row" fxLayoutAlign="start">

                                                <div class="h6 text-bold"><mat-icon class="s-20">vertical_split</mat-icon> Quote Activities</div>
                                            </div>
                                            <div fxLayout="column">
                                                <table class="simple">
                                                    <tbody>
                                                        <tr *ngFor="let activity of items.quoteActivity">
                                                            <td>
                                                                <div class="font-size-12 text-bold">{{activity.activityTypeName}}</div>
                                                                <div class="font-size-10 text-secondary">{{activity.description}}</div>
                                                                <div class="font-size-10 blue-600-fg">{{activity.createDate | date:'short'}}</div>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div> 
                            </div>
                        </mat-tab>
                        <mat-tab label="Vehicle Activity">
                            <div fxLayout="column" class="p-16">
                                <mat-card>
                                    Content goes here
                                </mat-card>
                            </div>
                            
                        </mat-tab>
                    </mat-tab-group>
            </div>
        </mat-expansion-panel>
    </mat-accordion>
</div>

